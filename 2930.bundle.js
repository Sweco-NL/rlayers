"use strict";(self.webpackChunkrlayers=self.webpackChunkrlayers||[]).push([[2930],{2930:(e,t,r)=>{r.r(t),r.d(t,{default:()=>P});var a=r(7294),n=r(6414),s=r(1090),o=r(2083),l=r(3475),c=r(9646);const i=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,u=/^H.([A-Z]{3}).*?:(.*)/,d=/^HFDTE(\d{2})(\d{2})(\d{2})/,m=/\r\n|\r|\n/;class p extends l.Z{constructor(e){super(),e=e||{},this.dataProjection=(0,n.U2)("EPSG:4326"),this.altitudeMode_=e.altitudeMode?e.altitudeMode:"none"}readFeatureFromText(e,t){const r=this.altitudeMode_,a=e.split(m),n={},l=[];let p,f,g=2e3,h=0,C=1,E=-1;for(p=0,f=a.length;p<f;++p){const e=a[p];let t;if("B"==e.charAt(0)){if(t=i.exec(e),t){const e=parseInt(t[1],10),a=parseInt(t[2],10),n=parseInt(t[3],10);let s=parseInt(t[4],10)+parseInt(t[5],10)/6e4;"S"==t[6]&&(s=-s);let o=parseInt(t[7],10)+parseInt(t[8],10)/6e4;if("W"==t[9]&&(o=-o),l.push(o,s),"none"!=r){let e;e="gps"==r?parseInt(t[11],10):"barometric"==r?parseInt(t[12],10):0,l.push(e)}let c=Date.UTC(g,h,C,e,a,n);c<E&&(c=Date.UTC(g,h,C+1,e,a,n)),l.push(c/1e3),E=c}}else"H"==e.charAt(0)&&(t=d.exec(e),t?(C=parseInt(t[1],10),h=parseInt(t[2],10)-1,g=2e3+parseInt(t[3],10)):(t=u.exec(e),t&&(n[t[1]]=t[2].trim())))}if(0===l.length)return null;const b="none"==r?"XYM":"XYZM",w=new o.Z(l,b),x=new s.Z((0,c.fI)(w,!1,t));return x.setProperties(n,!0),x}readFeaturesFromText(e,t){const r=this.readFeatureFromText(e,t);return r?[r]:[]}}const f=p;var g=r(5069),h=r(6101),C=r(6234),E=r(188),b=r(9854),w=r(9404);r(2031);const x=[{c:"rgba(0, 0, 250, 0.7)",i:r.p+"35f98571579c799828e73f3e7cfc5634.igc"},{c:"rgba(0, 50, 200, 0.7)",i:r.p+"08d341a63428255a9f42d1dad7e19df5.igc"},{c:"rgba(0, 100, 150, 0.7)",i:r.p+"6634c672e2855bfb2def3ad33d01b0e4.igc"},{c:"rgba(0, 150, 200, 0.7)",i:r.p+"dbecb26a49a66da3c0a27ee0ad994925.igc"},{c:"rgba(0, 200, 50, 0.7)",i:r.p+"5f9b60a43fcd910126e0dff92120e4d7.igc"}],y=(0,n.mi)([6,45.7]);function P(){const[e,t]=a.useState(""),[r,s]=a.useState(null),[l,c]=a.useState(null),[i,u]=a.useState(0),[d,m]=a.useState([]),[p,P]=a.useState({start:1/0,stop:-1/0,duration:0}),[S,I]=a.useState((()=>(Promise.all(x.map((e=>fetch(e.i).then((e=>e.text()))))).then((e=>I(e))),[]))),M={redCircle:(0,w.yO)(),blueCircle:(0,w.yO)(),flightPath:a.useRef([])},T=a.useRef(),v=a.useRef();return a.createElement(a.Fragment,null,a.useMemo((()=>x.map(((e,t)=>a.createElement(w.P_,{key:t,ref:e=>M.flightPath.current[t]=e},a.createElement(w.c5,{color:e.c,width:3}))))),[M.flightPath]),a.createElement(w.P_,{ref:M.redCircle},a.createElement(w.c5,{color:"red",width:1}),a.createElement(w.Au,{radius:6},a.createElement(w.X3,{color:"red"}))),a.createElement(w.P_,{ref:M.blueCircle},a.createElement(w.Au,{radius:6},a.createElement(w.X3,{color:"blue"}))),a.createElement(b.rO,{className:"example-map",initial:{center:y,zoom:9},onPointerMove:(0,a.useCallback)((e=>{const r=T.current.source.getClosestFeatureToCoordinate(e.coordinate);if(null===r)return;const a=r.getGeometry().getClosestPoint(e.coordinate),n=new Date(1e3*a[2]);s(new E.Z(a)),c(new o.Z([e.coordinate,[a[0],a[1]]])),t("<strong>"+r.get("PLT")+"</strong><br><em>"+n.toUTCString()+"</em>"),e.map.render()}),[T])},a.createElement(b.zV,{zIndex:5,url:"https://{a-c}.tile.opentopomap.org/{z}/{x}/{y}.png",attributions:"Kartendaten: © OpenStreetMap-Mitwirkende, SRTM | Kartendarstellung: © OpenTopoMap (CC-BY-SA)"}),a.createElement(b.jh,{zIndex:10,ref:T,onAddFeature:(0,a.useCallback)((e=>{const t=e.feature.getGeometry();p.start=Math.min(p.start,t.getFirstCoordinate()[2]),p.stop=Math.max(p.stop,t.getLastCoordinate()[2]),p.duration=p.stop-p.start,P({...p})}),[p]),onPostRender:(0,a.useCallback)((e=>{const t=function(e){if(!(e.context instanceof CanvasRenderingContext2D))throw new Error("Only works for render events from Canvas 2D layers");const t=e.inversePixelTransform[0],r=e.frameState,a=(0,h.Jp)(e.inversePixelTransform.slice(),r.coordinateToPixelTransform),s=(0,C.se)(r.viewState.resolution,t);let o;const l=(0,n.Cs)();return l&&(o=(0,n.WO)(l,r.viewState.projection)),new g.Z(e.context,t,r.extent,a,r.viewState.rotation,s,o)}(e);t.setStyle(w.P_.getStyleStatic(M.redCircle)),r&&l&&(t.drawGeometry(r),t.drawGeometry(l))}),[r,l,M.redCircle])},a.useMemo((()=>a.createElement(a.Fragment,null,S.map(((e,t)=>a.createElement(b.j$,{key:t,feature:(new f).readFeatures(e,{featureProjection:"EPSG:3857"})[0],style:M.flightPath.current[t]}))))),[S,M.flightPath,M.flightPath.current[0]])),a.createElement(b.jh,{zIndex:10,ref:v,style:M.blueCircle},a.useMemo((()=>a.createElement(a.Fragment,null,d.map(((e,t)=>a.createElement(b.j$,{key:t,geometry:new E.Z(e)}))))),[d]))),a.createElement("div",{className:"d-flex flex-row mb-3 align-items-center"},a.createElement("div",{className:"jumbotron py-1 px-3 m-0 me-3 w-50",dangerouslySetInnerHTML:{__html:e}}),a.createElement("div",{className:"w-50"},a.createElement("input",{type:"range",className:"range-slider range-slider--primary w-100",min:"0",max:"100",value:i,onChange:(0,a.useCallback)((e=>{const t=parseInt(e.currentTarget.value);u(t);const r=T.current.source,a=p.start+p.duration*t/100,n=[];r.forEachFeature((e=>{if(!e.get("PLT"))return;const t=e.getGeometry().getCoordinateAtM(a,!0);n.push(t)})),m(n)}),[T,p])}))))}}}]);